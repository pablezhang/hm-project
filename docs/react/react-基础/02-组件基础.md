- # å­¦ä¹ ç›®æ ‡

  - èƒ½å¤Ÿä½¿ç”¨å‡½æ•°åˆ›å»ºç»„ä»¶ - å‡½æ•°ç»„ä»¶
  - èƒ½å¤ŸæŒæ¡ class è¯­æ³• extends ç»§æ‰¿
  - èƒ½å¤Ÿä½¿ç”¨ class åˆ›å»ºç»„ä»¶-ç±»ç»„ä»¶
  - èƒ½å¤Ÿç»™ React å…ƒç´ ç»‘å®šäº‹ä»¶
  - èƒ½å¤Ÿä½¿ç”¨ state ä¸ setState
  - èƒ½å¤Ÿå¤„ç†äº‹ä»¶ä¸­ this çš„æŒ‡å‘é—®é¢˜
  - èƒ½å¤Ÿä½¿ç”¨å—æ§ç»„ä»¶æ–¹å¼å¤„ç†è¡¨å•

  # ç»„ä»¶åŸºæœ¬ä»‹ç»

  - ç»„ä»¶æ˜¯ React ä¸­æœ€åŸºæœ¬çš„å†…å®¹ï¼Œä½¿ç”¨ React å°±æ˜¯åœ¨ä½¿ç”¨ç»„ä»¶
  - ç»„ä»¶è¡¨ç¤ºé¡µé¢ä¸­çš„éƒ¨åˆ†åŠŸèƒ½
  - å¤šä¸ªç»„ä»¶å¯ä»¥å®ç°å®Œæ•´çš„é¡µé¢åŠŸèƒ½
  - ç»„ä»¶ç‰¹ç‚¹ï¼šå¯å¤ç”¨ï¼Œç‹¬ç«‹ï¼Œå¯ç»„åˆ

  ![](./images/ç»„ä»¶.png)

  # React åˆ›å»ºç»„ä»¶çš„ä¸¤ç§æ–¹å¼

  ## å‡½æ•°ç»„ä»¶

  > å‡½æ•°ç»„ä»¶ï¼šä½¿ç”¨ JS çš„å‡½æ•°æˆ–è€…ç®­å¤´å‡½æ•°åˆ›å»ºçš„ç»„ä»¶

  - ä¸ºäº†åŒºåˆ†æ™®é€šæ ‡ç­¾ï¼Œå‡½æ•°ç»„ä»¶çš„åç§°å¿…é¡» `å¤§å†™å­—æ¯å¼€å¤´`
  - å‡½æ•°ç»„ä»¶`å¿…é¡»æœ‰è¿”å›å€¼`ï¼Œè¡¨ç¤ºè¯¥ç»„ä»¶çš„ç»“æ„
  - å¦‚æœç»„ä»¶ä¸æ¸²æŸ“ä»»ä½•å†…å®¹ï¼Œå¯ä»¥è¿”å› null

  ä½¿ç”¨å‡½æ•°åˆ›å»ºç»„ä»¶

  ```jsx
  function Hello() {
    return <div>è¿™æ˜¯æˆ‘çš„å‡½æ•°ç»„ä»¶</div>;
  }
  ```

  ä½¿ç”¨ç®­å¤´å‡½æ•°åˆ›å»ºç»„ä»¶

  ```jsx
  const Hello = () => <div>è¿™æ˜¯ä¸€ä¸ªå‡½æ•°ç»„ä»¶</div>;
  ```

  ä½¿ç”¨ç»„ä»¶

  ```jsx
  ReactDOM.render(<Hello />, document.getElementById('root'));
  ```

  ### ç»ƒä¹ è¿‡ç¨‹ä¸­çš„é—®é¢˜

  - return åæ•²å›è½¦æ¢è¡Œäº†ï¼Œjs ä¼šåœ¨ reutrn åæ’å…¥åˆ†å·ç»“æŸã€‚

  ## ç±»ä¸ç»§æ‰¿

  ### class åŸºæœ¬è¯­æ³•

  - åœ¨ ES6 ä¹‹å‰é€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡
  - åœ¨ ES6 ä¸­æ–°å¢äº†ä¸€ä¸ªå…³é”®å­— class, ç±» å’Œæ„é€ å‡½æ•°ç±»ä¼¼ï¼Œç”¨äºåˆ›å»ºå¯¹è±¡
    - ç±»ä¸å¯¹è±¡çš„åŒºåˆ«
    - ç±»ï¼šæŒ‡çš„æ˜¯ä¸€ç±»çš„äº‹ç‰©ï¼Œæ˜¯ä¸ªæ¦‚å¿µï¼Œæ¯”å¦‚è½¦ æ‰‹æœº æ°´æ¯ç­‰
    - å¯¹è±¡ï¼šä¸€ä¸ªå…·ä½“çš„äº‹ç‰©ï¼Œæœ‰å…·ä½“çš„ç‰¹å¾å’Œè¡Œä¸ºï¼Œæ¯”å¦‚ä¸€ä¸ªæ‰‹æœºï¼Œæˆ‘çš„æ‰‹æœºç­‰ï¼Œ ç±»å¯ä»¥åˆ›å»ºå‡ºæ¥å¯¹è±¡ã€‚
  - ç±»åˆ›å»ºå¯¹è±¡çš„åŸºæœ¬è¯­æ³•
    - åŸºæœ¬è¯­æ³•`class ç±»å{ }`
    - æ„é€ å‡½æ•° `constructor` çš„ç”¨æ³•ï¼Œåˆ›å»ºå¯¹è±¡
    - åœ¨ç±»ä¸­æä¾›æ–¹æ³•ï¼Œç›´æ¥æä¾›å³å¯
    - ğŸ’¥ğŸ’¥ åœ¨ç±»ä¸­ä¸éœ€è¦ä½¿ç”¨åˆ†å·ï¼Œåˆ†éš”ï¼ˆVue å› ä¸ºæ˜¯å¯¹è±¡æ‰éœ€è¦åˆ†å·åˆ†éš”ï¼‰

  ### extends å®ç°ç»§æ‰¿

  - extends åŸºæœ¬ä½¿ç”¨
  - ç±»å¯ä»¥ä½¿ç”¨å®ƒç»§æ‰¿çš„ç±»ä¸­æ‰€æœ‰çš„æˆå‘˜ï¼ˆå±æ€§å’Œæ–¹æ³•ï¼‰
  - ç±»ä¸­å¯ä»¥æä¾›è‡ªå·±çš„å±æ€§å’Œæ–¹æ³•
  - æ³¨æ„ï¼šå¦‚æœæƒ³è¦ç»™ç±»ä¸­æ–°å¢å±æ€§ï¼Œå¿…é¡»å…ˆè°ƒç”¨ super æ–¹æ³•

  ### æ³¨æ„

  1. ğŸ’¥ğŸ’¥ åœ¨ç±»ä¸­ä¸éœ€è¦ä½¿ç”¨åˆ†å·ï¼Œåˆ†éš”ï¼ˆVue å› ä¸ºæ˜¯å¯¹è±¡æ‰éœ€è¦åˆ†å·åˆ†éš”ï¼‰
  2. ç±»ç»„ä»¶éœ€è¦ç»§æ‰¿äº `React.Component`

## ç±»ç»„ä»¶

> ç±»ç»„ä»¶ï¼šä½¿ç”¨ ES6 çš„ class è¯­æ³•åˆ›å»ºç»„ä»¶

çº¦å®š 1ï¼šç±»ç»„ä»¶çš„åç§°å¿…é¡»æ˜¯å¤§å†™å­—æ¯å¼€å¤´

çº¦å®š 2ï¼šç±»ç»„ä»¶åº”è¯¥ç»§æ‰¿`React.Component`çˆ¶ç±»ï¼Œä»è€Œå¯ä»¥ä½¿ç”¨çˆ¶ç±»ä¸­æä¾›çš„æ–¹æ³•æˆ–è€…å±æ€§

çº¦å®š 3ï¼šç±»ç»„ä»¶å¿…é¡»æä¾›`render`æ–¹æ³•ï¼Œå¹¶è¿”å›ç»„ä»¶çš„ç»“æ„ï¼Œå¦‚æ— éœ€è¦è¿”å›çš„ç»“æ„ï¼Œè¿”å› null

å®šä¹‰ç»„ä»¶

```jsx
class Hello extends React.Component {
  render() {
    return <div>è¿™æ˜¯ä¸€ä¸ªç±»ç»„ä»¶</div>;
  }
}
```

ä½¿ç”¨ç»„ä»¶

```jsx
ReactDOM.render(<Hello />, document.getElementById('root'));
```

## å°†ç»„ä»¶æå–åˆ°å•ç‹¬çš„ js æ–‡ä»¶ä¸­

æ€è€ƒï¼šé¡¹ç›®ä¸­çš„ç»„ä»¶å¤šäº†ä¹‹åï¼Œè¯¥å¦‚ä½•ç»„ç»‡è¿™äº›ç»„ä»¶å‘¢ï¼Ÿ

- é€‰æ‹©ä¸€ï¼šå°†æ‰€æœ‰ç»„ä»¶æ”¾åœ¨åŒä¸€ä¸ª JS æ–‡ä»¶ä¸­

- é€‰æ‹©äºŒï¼šå°†æ¯ä¸ªç»„ä»¶æ”¾åˆ°å•ç‹¬çš„ JS æ–‡ä»¶ä¸­

- **æ¨èé€‰æ‹©äºŒ**-ç»„ä»¶ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„ä¸ªä½“ï¼Œä¸€èˆ¬éƒ½ä¼šæ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„ JS æ–‡ä»¶ä¸­

å®ç°æ–¹å¼

1. åˆ›å»º Hello.js
2. åˆ›å»ºç»„ä»¶ï¼ˆå‡½æ•° æˆ– ç±»ï¼‰
3. åœ¨ Hello.js ä¸­å¯¼å‡ºè¯¥ç»„ä»¶
4. åœ¨ index.js ä¸­å¯¼å…¥ Hello ç»„ä»¶
5. æ¸²æŸ“ç»„ä»¶ï¼Œ

## ç±»ç»„ä»¶çš„çŠ¶æ€ state

- çŠ¶æ€`state`å³æ•°æ®ï¼Œç±»ä¼¼ Vue ä¸­çš„ dataï¼Œã€‚
- React åŒæ ·æ˜¯æ•°æ®é©±åŠ¨è§†å›¾ **æ›´æ–° UI**ï¼Œï¼ˆåŒ Vue çš„ dataï¼‰ã€‚
- çŠ¶æ€`state` æ˜¯ç»„ä»¶å†…éƒ¨çš„`ç§æœ‰æ•°æ®`ï¼Œç‹¬ç«‹ä½œç”¨åŸŸï¼Œï¼ˆåŒ Vue çš„ dataï¼‰ã€‚
- `stateçš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡`, è¡¨ç¤ºä¸€ä¸ªç»„ä»¶ä¸­å¯ä»¥æœ‰å¤šä¸ªæ•°æ®
- æ—©æœŸï¼Œ**åªæœ‰ç±»ç»„ä»¶**ï¼Œå¯ä»¥å®šä¹‰çŠ¶æ€ã€‚ã€ç°åœ¨å‡½æ•°å¼ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥å®šä¹‰çŠ¶æ€ã€‘

- ç®€æ´çš„è¯­æ³•

```jsx
class Hello extends React.Component {
  state = {
    msg: 'hello react',
  };
  render() {
    return <div>stateä¸­çš„æ•°æ®--{this.state.msg}</div>;
  }
}
```

- å¤æ‚çš„å†™æ³•

```jsx
class Hello extends React.Component {
  constructor() {
    // æ„é€ å‡½æ•°ä¸­ï¼Œæƒ³ä½¿ç”¨thisï¼Œsuper()å¿…é¡»è°ƒç”¨
    super();
    // ç»„ä»¶é€šè¿‡stateæä¾›æ•°æ®
    this.state = {
      msg: 'hello react',
    };
  }
  render() {
    return <div>stateä¸­çš„æ•°æ®--{this.state.msg}</div>;
  }
}
```

**æ€»ç»“ï¼š**

1. `state = {}` æ˜¯å›ºå®šçš„å†™æ³•ï¼Œç‹¬ç«‹ä½œç”¨åŸŸã€‚
2. class ç»„ä»¶ä¸­æ‰æœ‰å£°æ˜`state` çš„å†™æ³•ï¼Œå‡½æ•°ç»„ä»¶ä¸­æ²¡æœ‰
3. ä½¿ç”¨å˜é‡ï¼Œé€šè¿‡`this.state.å±æ€§å` çš„æ–¹å¼æ¥è®¿é—®
4. React ä¸­åŒæ ·æ˜¯æ•°æ®é©±åŠ¨è§†å›¾ï¼Œæ•°æ®å˜åŒ–å¯¼è‡´ UI æ›´æ–°ã€‚
5. æ—©æœŸï¼Œ**åªæœ‰ç±»ç»„ä»¶**ï¼Œå¯ä»¥å®šä¹‰çŠ¶æ€

## react æ’ä»¶çš„å®‰è£…ï¼ˆæ²¡ç½‘ï¼‰

å®‰è£…è°·æ­Œæ’ä»¶`react-devtools`

## ç»„ä»¶ç±»å‹-æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶

- **æ— çŠ¶æ€ç»„ä»¶** : æ—©æœŸï¼Œå‡½æ•°ç»„ä»¶æ˜¯ä¸èƒ½è‡ªå·±æä¾›æ•°æ®ã€å‰æï¼šåŸºäº hooks ä¹‹å‰è¯´çš„ã€‘
- **æœ‰çŠ¶æ€ç»„ä»¶** : ç±»ç»„ä»¶å¯ä»¥è‡ªå·±æä¾›æ•°æ®ï¼Œç»„ä»¶å†…éƒ¨çš„çŠ¶æ€ï¼ˆæ•°æ®å¦‚æœå‘ç”Ÿäº†æ”¹å˜ï¼Œå†…å®¹ä¼šè‡ªåŠ¨çš„æ›´æ–°ï¼‰ï¼Œæ•°æ®é©±åŠ¨è§†å›¾

**æ³¨æ„**ï¼š

- ç°åœ¨å‡½æ•°ç»„ä»¶ä¹Ÿå¯ä»¥å®šä¹‰çŠ¶æ€ã€‚ã€æ—©æœŸï¼Œå‡½æ•°ç»„ä»¶æ˜¯æ²¡æœ‰çŠ¶æ€çš„ã€‘

* åœ¨å¤æ‚çš„é¡¹ç›®ä¸­ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”±å‡½æ•°ç»„ä»¶å’Œç±»ç»„ä»¶å…±åŒé…åˆæ¥å®Œæˆçš„ã€‚ã€class å¢åŠ äº†ä½¿ç”¨è€…çš„è´Ÿæ‹…ï¼Œæ‰€ä»¥åæ¥æœ‰äº† hooksã€‘

# äº‹ä»¶å¤„ç†

é—®é¢˜ï¼šReact ä¸­æ€ä¹ˆç»™ DOM ç»‘å®šä¸€ä¸ªäº‹ä»¶å‘¢ï¼Ÿ

## æ³¨å†Œäº‹ä»¶

React æ³¨å†Œäº‹ä»¶ä¸ DOM çš„äº‹ä»¶è¯­æ³•éå¸¸åƒ

è¯­æ³•`on+äº‹ä»¶å=ï½›äº‹ä»¶å¤„ç†ç¨‹åºï½` æ¯”å¦‚`onClick={this.handleClick}`

æ³¨æ„ï¼š**React äº‹ä»¶é‡‡ç”¨é©¼å³°å‘½åæ³•**ï¼Œæ¯”å¦‚`onMouseEnter`, `onClick`

```jsx
class App extends React.Component {
  render() {
    return (
      <div>
        <button onClick={this.handleClick}>ç‚¹æˆ‘</button>
      </div>
    );
  }

  handleClick() {
    console.log('ç‚¹å‡»äº‹ä»¶è§¦å‘äº†');
  }
}
```

## äº‹ä»¶å¯¹è±¡

- å¯ä»¥é€šè¿‡äº‹ä»¶å¤„ç†å‡½æ•°çš„å½¢å‚è·å–åˆ°äº‹ä»¶å¯¹è±¡

```jsx
function handleClick(e) {
  e.preventDefault();
  console.log('äº‹ä»¶å¯¹è±¡', e);
}
<a onClick={this.handleClick}>ç‚¹æˆ‘ï¼Œä¸ä¼šè·³è½¬é¡µé¢</a>;
```

ES6 ç®­å¤´å‡½æ•°è¡¥å……

1. ç®€å†™çœç•¥ return ä¸ {}ã€‚
2. return åçš„è¯­å¥ä¼šæ‰§è¡Œã€‚
3. ç®­å¤´å‡½æ•°åŒ…ä¸€å±‚ä¼ å‚ã€‚

## äº‹ä»¶ä¼ å€¼

- æ–¹æ³•ï¼šåŒ…ä¸€å±‚ç®­å¤´å‡½æ•°ï¼Œåœ¨ç®­å¤´å‡½æ•°ä¸­ï¼Œè°ƒç”¨å¤„ç†å‡½æ•°ã€‚
- è®°å¿†å£è¯€ï¼šåŠ ä¸ªç®­å¤´ï¼Œå˜æˆç®­å¤´å‡½æ•°ã€‚

å†™æ³•ï¼š

- å®Œæ•´å†™æ³•

```react
<a
    onClick={(e) => {
        this.handleClick(e, 'hello React')
    }}
>ç‚¹æˆ‘ï¼Œä¸ä¼šè·³è½¬é¡µé¢</a>
```

- ç®€å†™-**æ¨è**ï¼šçœç•¥äº†èŠ±æ‹¬å·ï¼Œæ›´åˆ©äºé˜…è¯»

```react
<a onClick={(e) => this.handleClick(e, 'hello React') }>ç‚¹æˆ‘ï¼Œä¸ä¼šè·³è½¬é¡µé¢</a>
```

## this æŒ‡å‘é—®é¢˜

> äº‹ä»¶å¤„ç†ç¨‹åºä¸­çš„ this æŒ‡å‘çš„æ˜¯ undefined
>
> 1. render æ–¹æ³•ä¸­çš„ this æ²¡æœ‰é—®é¢˜ï¼ŒæŒ‡å‘å½“å‰ react ç»„ä»¶å®ä¾‹ã€‚
>
> 2. **åªæœ‰äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„ this æœ‰é—®é¢˜**

```jsx
class App extends React.Component {
  state = {
    msg: 'hello react',
  };

  handleClick() {
    console.log(this.state.msg);
  }

  render() {
    return (
      <div>
        <button onClick={this.handleClick}>ç‚¹æˆ‘</button>
      </div>
    );
  }
}
```

## this æŒ‡å‘é—®é¢˜è§£å†³æ–¹æ¡ˆ

```js
æ–¹æ¡ˆ1ï¼šrenderä¸­ä½¿ç”¨ç®­å¤´å‡½æ•°
æ–¹æ¡ˆ2ï¼šbindä¿®æ”¹thisæŒ‡å‘
æ–¹æ¡ˆ3ï¼šclassç®­å¤´å‡½æ•°æ–¹æ³• - æ¨èâœ…
```

- è§£å†³æ–¹æ¡ˆ 1ï¼šåœ¨ render ä¸­ä½¿ç”¨ç®­å¤´å‡½æ•°

ç®­å¤´å‡½æ•°çš„ç‰¹ç‚¹ï¼šè‡ªèº«æ²¡æœ‰ thisï¼Œè®¿é—®çš„æ˜¯å¤–éƒ¨çš„ this

```jsx
class App extends React.Component {
  state = {
    msg: 'hello react'
  }

  handleClick() {
    console.log(this.state.msg)
  }

  render() {
    return (
      <div>
        <button onClick={() => { console.log(this.state.msg) }>ç‚¹æˆ‘</button>
        <button onClick={() => {this.handleClick()}}>ç‚¹æˆ‘</button>
      </div>
    )
  }
}
```

ç¼ºç‚¹ï¼šä¼šæŠŠå¤§é‡çš„ js å¤„ç†é€»è¾‘æ”¾åˆ° JSX ä¸­ï¼Œå°†æ¥ä¸å®¹æ˜“ç»´æŠ¤

- è§£å†³æ–¹æ¡ˆ 2ï¼šä½¿ç”¨ bind
- åŸç”Ÿ JS å¤ä¹ ï¼šapply å’Œ call æ”¹å˜ this æŒ‡å‘çš„åŒæ—¶ï¼Œä¼šç›´æ¥è°ƒç”¨å‡½æ•°
- åŸç”Ÿ JS å¤ä¹ ï¼šbind åªæ˜¯æ”¹å˜ this æŒ‡å‘ï¼Œä½†ä¸è°ƒç”¨å‡½æ•°

```jsx
class App extends React.Component {
  state = {
    msg: 'hello react',
  };
  handleClick() {
    console.log(this.state.msg);
  }
  render() {
    return (
      <div>
        <button onClick={this.handleClick.bind(this)}>ç‚¹æˆ‘</button>
      </div>
    );
  }
}
```

- è§£å†³æ–¹æ¡ˆ 3ï¼šclass ç®­å¤´å‡½æ•°æ–¹æ³• - ğŸ””**æ¨è**

```js
class App extends React.Component {
  state = {
    msg: 'hello react',
  };

  handleClick = () => {
    console.log(this.state.msg);
  };
  render() {
    return (
      <div>
        <button onClick={this.handleClick}>ç‚¹æˆ‘</button>
      </div>
    );
  }
}
```

**æ³¨æ„ï¼šè¿™ä¸ªè¯­æ³•æ˜¯è¯•éªŒæ€§çš„è¯­æ³•ï¼Œä½†æ˜¯æœ‰ babel çš„è½¬ä¹‰ï¼Œæ‰€ä»¥æ²¡æœ‰ä»»ä½•é—®é¢˜**

# setState ä¿®æ”¹çŠ¶æ€

é—®é¢˜ï¼š

1.  React ä¸­å¯ä»¥ä¿®æ”¹çŠ¶æ€`state` å—ï¼Ÿ
2.  å¯ä»¥ç›´æ¥åƒ Vue ä¸€æ ·å¯¹çŠ¶æ€èµ‹å€¼å—ï¼Ÿ

```react
class App extends React.Component {
  state = {
    count: 1
  }
  handleClick = () => {
  // ä¿®æ”¹çŠ¶æ€state
  }
  render() {
    return (
      <div>
        <p>æ¬¡æ•°: {this.state.count}</p>
        <button onClick={this.handleClick}>ç‚¹æˆ‘+1</button>
      </div>
    )
  }
}
```

- ç»„ä»¶ä¸­çš„çŠ¶æ€æ˜¯å¯å˜çš„
- è¯­æ³•`this.setState({è¦ä¿®æ”¹çš„æ•°æ®å: æ–°çš„å€¼})`
- æ³¨æ„ï¼šä¸è¦ç›´æ¥ä¿®æ”¹ state ä¸­çš„å€¼ï¼Œå¿…é¡»é€šè¿‡`this.setState()`æ–¹æ³•è¿›è¡Œä¿®æ”¹
- `setState`çš„ä½œç”¨

  - ä¿®æ”¹ state
  - æ›´æ–° UI

- æ€æƒ³ï¼šæ•°æ®é©±åŠ¨è§†å›¾

```jsx
class App extends React.Component {
  state = {
    count: 1,
  };
  handleClick() {
    this.setState({
      count: this.state.count + 1,
    });
  }
  render() {
    return (
      <div>
        <p>æ¬¡æ•°: {this.state.count}</p>
        <button onClick={this.handleClick.bind(this)}>ç‚¹æˆ‘+1</button>
      </div>
    );
  }
}
```

- react ä¸­æ ¸å¿ƒç†å¿µï¼š**çŠ¶æ€ä¸å¯å˜**
  - ä¸è¦ç›´æ¥ä¿®æ”¹ react ä¸­ state çš„å€¼ï¼Œè€Œæ˜¯æä¾›æ–°çš„å€¼
  - ç›´æ¥ä¿®æ”¹ react ä¸­ state çš„å€¼ï¼Œç»„ä»¶å¹¶ä¸ä¼šæ›´æ–°

```jsx
state = {
  count: 0,
  list: [],
};
// âŒé”™è¯¯æ“ä½œï¼šç›´æ¥ä¿®æ”¹å€¼çš„æ“ä½œ
this.state.count++;
this.state.list.push('a');

// âœ…æ­£ç¡®æ“ä½œï¼šåˆ›å»ºæ–°çš„å€¼çš„æ“ä½œ
this.setState({
  count: this.state.count + 1,
  list: [...this.state.list, 'b'],
});
```

# ç»ƒä¹ -è´­ç‰©è½¦åŠ å‡

> è¦æ±‚ï¼šåŠ å‡æŒ‰é’®ï¼Œç»‘å®šåŒä¸€ä¸ªå¤„ç†å‡½æ•°

æ•ˆæœå¦‚ä¸‹ï¼š

![image-20211208215255325](./images/åŠ å‡å™¨.png)

åŸºæœ¬çš„ç»„ä»¶ä»£ç ï¼š

```
class App extends React.Component {
  state = {
    count: 0,
  };

  render() {
    return (
      <div>
        <p>å½“å‰æ•°å€¼ä¸ºï¼š{this.state.count}</p>
        <hr />
        <button>+1</button>
        <span>{this.state.count}</span>
        <button>-1</button>
      </div>
    );
  }
}

```

# è¡¨å•å¤„ç†

> æˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç»å¸¸éœ€è¦æ“ä½œè¡¨å•å…ƒç´ ï¼Œæ¯”å¦‚è·å–è¡¨å•çš„å€¼æˆ–è€…æ˜¯è®¾ç½®è¡¨å•çš„å€¼ã€‚

react ä¸­å¤„ç†è¡¨å•å…ƒç´ æœ‰ä¸¤ç§æ–¹å¼ï¼š

- å—æ§ç»„ä»¶-è¡¨å•å…ƒç´ çš„ value å—åˆ° state çš„æ§åˆ¶ï¼Œï¼ˆç±»ä¼¼ Vue ä¸­çš„ v-modelï¼‰
- éå—æ§ç»„ä»¶ï¼ˆDOM æ“ä½œï¼‰

## å—æ§ç»„ä»¶åŸºæœ¬æ¦‚å¿µ

- React ä¸­å°† state ä¸­çš„æ•°æ®ä¸è¡¨å•å…ƒç´ çš„ value å€¼ç»‘å®šåˆ°äº†ä¸€èµ·ï¼Œ`ç”±stateçš„å€¼æ¥æ§åˆ¶è¡¨å•å…ƒç´ çš„å€¼`
- ä½†æ˜¯åœ¨ react ä¸­ï¼Œå¯å˜çŠ¶æ€é€šå¸¸æ˜¯ä¿å­˜åœ¨ state ä¸­çš„ï¼Œå¹¶ä¸”è¦æ±‚çŠ¶æ€åªèƒ½é€šè¿‡`setState`è¿›è¡Œä¿®æ”¹ã€‚
- å—æ§ç»„ä»¶ï¼š**value å€¼å—åˆ°äº† statet æ§åˆ¶çš„è¡¨å•å…ƒç´ **

![](./images/å—æ§ç»„ä»¶.png)

## å—æ§ç»„ä»¶ä½¿ç”¨æ­¥éª¤

1. åœ¨ state ä¸­æ·»åŠ ä¸€ä¸ªçŠ¶æ€ï¼Œä½œä¸ºè¡¨å•å…ƒç´ çš„ value å€¼ï¼ˆæ§åˆ¶è¡¨å•å…ƒç´ çš„å€¼ï¼‰
2. ç»™è¡¨å•å…ƒç´ æ·»åŠ  change äº‹ä»¶ï¼Œè®¾ç½® state çš„å€¼ä¸ºè¡¨å•å…ƒç´ çš„å€¼ï¼ˆæ§åˆ¶å€¼çš„å˜åŒ–ï¼‰

```js
class App extends React.Component {
  state = {
    msg: 'hello react',
  };

  handleChange = (e) => {
    this.setState({
      msg: e.target.value,
    });
  };

  render() {
    return (
      <div>
        <input type="text" value={this.state.msg} onChange={this.handleChange} />
      </div>
    );
  }
}
```

## å¸¸è§çš„å—æ§ç»„ä»¶

- æ–‡æœ¬æ¡†ã€æ–‡æœ¬åŸŸã€ä¸‹æ‹‰æ¡†ï¼ˆæ“ä½œ value å±æ€§ï¼‰
- å¤é€‰æ¡†ï¼ˆæ“ä½œ checked å±æ€§ï¼‰

```js
class App extends React.Component {
  state = {
    usernmae: '',
    desc: '',
    city: '2',
    isSingle: true,
  };

  handleName = (e) => {
    this.setState({
      name: e.target.value,
    });
  };
  handleDesc = (e) => {
    this.setState({
      desc: e.target.value,
    });
  };
  handleCity = (e) => {
    this.setState({
      city: e.target.value,
    });
  };
  handleSingle = (e) => {
    this.setState({
      isSingle: e.target.checked,
    });
  };

  render() {
    return (
      <div>
        å§“åï¼š
        <input type="text" value={this.state.username} onChange={this.handleName} />
        <br />
        æè¿°ï¼š<textarea value={this.state.desc} onChange={this.handleDesc}></textarea>
        <br />
        åŸå¸‚ï¼š
        <select value={this.state.city} onChange={this.handleCity}>
          <option value="1">åŒ—äº¬</option>
          <option value="2">ä¸Šæµ·</option>
          <option value="3">å¹¿å·</option>
          <option value="4">æ·±åœ³</option>
        </select>
        <br />
        æ˜¯å¦å•èº«ï¼š
        <input type="checkbox" checked={this.state.isSingle} onChange={this.handleSingle} />
      </div>
    );
  }
}
```

æ€»ç»“ï¼š

1. `react` ä¸­`change` äº‹ä»¶ç­‰åŒäº html ä¸­çš„`input` äº‹ä»¶ã€‚
2. `react`ä¸­çš„`blur` äº‹ä»¶ï¼Œç­‰åŒäº html ä¸­çš„`change` äº‹ä»¶ã€‚
3. **æ¨è**ä½¿ç”¨`onChange` äº‹ä»¶ç›‘å¬ç”¨æˆ·è¾“å…¥ï¼Œ**ä¸æ¨è**ä½¿ç”¨`onInput`ã€‚

## å¤šè¡¨å•å…ƒç´ çš„ä¼˜åŒ–

é—®é¢˜ï¼šæ¯ä¸ªè¡¨å•å…ƒç´ éƒ½éœ€è¦ä¸€ä¸ªå•ç‹¬çš„äº‹ä»¶å¤„ç†ç¨‹åºï¼Œå¤„ç†å¤ªç¹ç

ä¼˜åŒ–ï¼šä½¿ç”¨ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºå¤„ç†å¤šä¸ªè¡¨å•å…ƒç´ 

æ­¥éª¤

- ç»™è¡¨å•å…ƒç´ æ·»åŠ  name å±æ€§ï¼Œåç§°ä¸ state å±æ€§åç›¸åŒ
- æ ¹æ®è¡¨å•å…ƒç´ ç±»å‹è·å–å¯¹åº”çš„å€¼
- åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­é€šè¿‡`[name]`ä¿®æ”¹å¯¹åº”çš„ state

```js
class App extends React.Component {
  state = {
    username: '',
    desc: '',
    city: '2',
    isSingle: true,
  };

  handleChange = (e) => {
    let { name, type, value, checked } = e.target;
    console.log(name, type, value, checked);
    value = type === 'checkbox' ? checked : value;
    console.log(name, value);
    this.setState({
      [name]: value,
    });
  };
  render() {
    return (
      <div>
        å§“åï¼š
        <input
          type="text"
          name="username"
          value={this.state.username}
          onChange={this.handleChange}
        />
        <br />
        æè¿°ï¼š<textarea name="desc" value={this.state.desc} onChange={this.handleChange}></textarea>
        <br />
        åŸå¸‚ï¼š
        <select name="city" value={this.state.city} onChange={this.handleChange}>
          <option value="1">åŒ—äº¬</option>
          <option value="2">ä¸Šæµ·</option>
          <option value="3">å¹¿å·</option>
          <option value="4">æ·±åœ³</option>
        </select>
        <br />
        æ˜¯å¦å•èº«ï¼š
        <input
          type="checkbox"
          name="isSingle"
          checked={this.state.isSingle}
          onChange={this.handleChange}
        />
      </div>
    );
  }
}
```

## éå—æ§ç»„ä»¶-ref

> è¡¨å•å…ƒç´ çš„ value ç”± DOM å¯¹è±¡æ§åˆ¶ï¼Œä¸å— state çš„æ§åˆ¶

æ€è€ƒï¼š

1. é™¤äº†ä½¿ç”¨`state` æ§åˆ¶è¡¨å•çš„æ•°æ®ï¼Œæ˜¯å¦æœ‰å…¶å®ƒçš„æ–¹å¼ï¼Ÿ

```react
/**
 * å­¦ä¹ ç›®æ ‡ï¼šäº†è§£éå—æ§ç»„ä»¶ - çœŸå®DOMå…·å¤‡ç®¡ç†è¡¨å•æ•°æ®çš„èƒ½åŠ›
 * å«ä¹‰ï¼šéå—æ§ç»„ä»¶-ç»„ä»¶å†…ï¼Œè¡¨å•çš„æ•°æ®å¯ï¼Œå¯ä»¥ä¸å—stateçš„æ§åˆ¶
 */
import React from 'react';
import ReactDOM from 'react-dom';

class App extends React.Component {
  handleClick = () => {
    // è¿™ç§ä¸éœ€è¦stateç®¡ç†æ•°æ®çš„è¡¨å•å…ƒç´ ï¼Œç§°ä¹‹ä¸ºéå—æ§ç»„ä»¶ï¼Œ
    // è·å–æ•°æ®ï¼š
    let data = {
      userName: document.querySelector('#username').value,
      desc: document.querySelector('#desc').value,
      city: document.querySelector('#city').value,
      isSingle: document.querySelector('#isSingle').checked,
    };

    console.log(data, 'data');
  };

  handleChange = (e) => {
    // ä¿®æ”¹æ•°æ®
    console.log(e.target.value, 'value');
  }

  render() {
    return (
      <div>
        å§“åï¼š
        <input type="text" name="username" id="username" />
        <br />
        æè¿°ï¼š<textarea name="desc" id="desc"></textarea>
        <br />
        åŸå¸‚ï¼š
        <select name="city" id="city">
          <option value="1">åŒ—äº¬</option>
          <option value="2">ä¸Šæµ·</option>
          <option value="3">å¹¿å·</option>
          <option value="4">æ·±åœ³</option>
        </select>
        <br />
        æ˜¯å¦å•èº«ï¼š
        <input name="isSingle" type="checkbox" id="isSingle" />
        <button onClick={this.handleClick}>ç‚¹å‡»æäº¤åˆ°åå°</button>
      </div>
    );
  }
}

ReactDOM.render(<App />, document.getElementById('root'));

```

**æ€»ç»“ï¼š**

1. çœŸå® DOM å…·å¤‡å­˜è·å–è¡¨å•æ•°æ®ã€ä¿®æ”¹è¡¨å•æ•°æ®çš„èƒ½åŠ›
2. è¡¨å•å…ƒç´ ï¼Œå®ƒçš„å€¼ç”± DOM æ§åˆ¶ï¼Œä¸ä½¿ç”¨ state æ§åˆ¶ï¼Œç§°ä¸ºéå—æ§ç»„ä»¶ã€‚
3. è¡¨å•å…ƒç´ ï¼Œå®ƒçš„å€¼ç”± state æ§åˆ¶ï¼Œç”± setState æ¥æ”¹å˜ï¼Œç§°ä¸ºå—æ§ç»„ä»¶ã€‚
4. **æ¨è-**ä½¿ç”¨å—æ§ç»„ä»¶ï¼ŒReact æ¨èæ•°æ®é©±åŠ¨è§†å›¾ã€‚

## Ref

**ä½œç”¨ï¼šè·å–ç»„ä»¶å®ä¾‹ã€è·å– DOM** ï¼ˆä½œç”¨ä¸ Vue ä¸­çš„ Ref ç›¸åŒ)

ç›®æ ‡ï¼šä½¿ç”¨ Ref è·å–æ–‡æœ¬æ¡†çš„ DOM å…ƒç´ 

ä½¿ç”¨æ­¥éª¤ï¼š

1. è°ƒç”¨`React.createRef()`æ–¹æ³•åˆ›å»ºä¸€ä¸ª ref å¯¹è±¡ï¼Œç”¨äºå…³è”æ¨¡æ¿ä¸­çš„æŸä¸ªå…ƒç´ ï¼Œåœ¨æ¨¡æ¿æ¸²æŸ“å®Œæ¯•åå¯ä»¥é€šè¿‡ ref å¯¹è±¡è®¿é—®åˆ°æ¨¡æ¿ä¸­çš„å…ƒç´ ã€‚

```js
txtRef = React.createRef();
```

2. å°†åˆ›å»ºå¥½çš„ ref å¯¹è±¡æ·»åŠ åˆ°æ–‡æœ¬æ¡†ä¸­

```js
<input type="text" ref={this.txtRef} />
```

3. é€šè¿‡ ref å¯¹è±¡è·å–æ–‡æœ¬æ¡†çš„å€¼

```js
handleClick = () => {
  console.log(this.txtRef.current.value);
};
```

æ€»ç»“ï¼š

1. ä½œç”¨ï¼šè·å–ç»„ä»¶å®ä¾‹ã€DOM å¯¹è±¡ã€‚ ï¼ˆä¸ Vue ä¸­çš„ refï¼Œåœ¨ä½œç”¨ä¸Šç›¸åŒï¼‰
2. ref çš„ä»·å€¼åœ¨äºè·å– **ç»„ä»¶å®ä¾‹å¯¹è±¡**ã€‚
3. ä½¿ç”¨æ­¥éª¤ï¼š
   1. åˆ›å»º ref å¯¹è±¡
   2. ç»‘å®šåˆ°ç»„ä»¶æˆ– DOM ä¸Š
   3. ä½¿ç”¨`this.refå¯¹è±¡.current` è·å–ç»„ä»¶æˆ– DOM

# ç»¼åˆæ¡ˆä¾‹

è¯„è®ºåˆ—è¡¨æ¡ˆä¾‹

é™æ€ç»“æ„å¦‚ä¸‹ï¼š

1. æ–°å»º`src/index.js`
2. æ–°å»º`src/index.css`

ä»£ç å¦‚ä¸‹ï¼Œç›´æ¥å¤åˆ¶ï¼š

`src/index.js`

```react
import React from 'react';
import ReactDOM from 'react-dom';

import './index.css';

class App extends React.Component {
  state = {
    // ç”¨æˆ·åè¾“å…¥æ¡†
    username: '',
    // è¯„è®ºå†…å®¹
    content: '',
  };

  render() {
    return (
      <div className="app">
        {/* è¡¨å•æäº¤çš„æ—¶å€™ï¼Œè¿è¡Œå‘å¸ƒè¯„è®ºçš„å‡½æ•° */}
        <form onSubmit={this.handlePublish}>
          <input className="user" type="text" placeholder="è¯·è¾“å…¥è¯„è®ºäºº" />
          <br />
          <textarea className="content" cols="30" rows="10" placeholder="è¯·è¾“å…¥è¯„è®ºå†…å®¹" />
          <br />
          <button>å‘è¡¨è¯„è®º</button>
          <button type="button">æ¸…ç©ºè¯„è®º</button>
        </form>
        <ul>
          <li>
            <h3>è¯„è®ºäºº: xxx</h3>
            <p>è¯„è®ºå†…å®¹ï¼šxxx</p>
            <button>åˆ é™¤</button>
          </li>
        </ul>
      </div>
    );
  }
}

// æ¸²æŸ“ç»„ä»¶
ReactDOM.render(<App />, document.getElementById('root'));

```

`src/index.css`

```css
.app {
  width: 300px;
  padding: 10px;
  border: 1px solid #999;
}

.user {
  width: 100%;
  box-sizing: border-box;
  margin-bottom: 10px;
}

.content {
  width: 100%;
  box-sizing: border-box;
  margin-bottom: 10px;
}

.no-comment {
  text-align: center;
  margin-top: 30px;
}
```

## åˆ—è¡¨å±•ç¤ºåŠŸèƒ½

æ¸²æŸ“è¯„è®ºåˆ—è¡¨ï¼ˆåˆ—è¡¨æ¸²æŸ“ï¼‰

- åœ¨ state ä¸­åˆå§‹åŒ–è¯„è®ºåˆ—è¡¨æ•°æ®
- ä½¿ç”¨æ•°ç»„çš„ map æ–¹æ³•éå†åˆ—è¡¨æ•°æ®
- ç»™æ¯ä¸ª li æ·»åŠ  key å±æ€§

## å‘è¡¨è¯„è®ºåŠŸèƒ½

è·å–è¯„è®ºä¿¡æ¯ï¼Œè¯„è®ºäººå’Œè¯„è®ºå†…å®¹ï¼ˆå—æ§ç»„ä»¶ï¼‰

- ä½¿ç”¨å—æ§ç»„ä»¶çš„æ–¹å¼è·å–è¯„è®ºæ•°æ®

å‘è¡¨è¯„è®ºï¼Œæ›´æ–°è¯„è®ºåˆ—è¡¨ï¼ˆæ›´æ–°çŠ¶æ€ï¼‰

- ç»™ list å¢åŠ ä¸€æ¡æ•°æ®

è¾¹ç•Œå¤„ç†

- æ¸…ç©ºå†…å®¹
- åˆ¤æ–­éç©º

## åˆ é™¤ä¸€æ¡è¯„è®º

- ç»™åˆ é™¤æŒ‰é’®ï¼Œç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°
- äº‹ä»¶å‡½æ•°ä¸­ï¼Œé€šè¿‡ id æˆ– indexï¼Œåˆ é™¤ list ä¸­ä¸€æ¡æ•°æ®

## æ¸…ç©ºè¯„è®ºåŠŸèƒ½

- ç»™æ¸…ç©ºè¯„è®ºæŒ‰é’®æ³¨å†Œäº‹ä»¶
- é€šè¿‡ setState æ¸…ç©ºè¯„è®ºåˆ—è¡¨
- æ²¡æœ‰æ›´å¤šè¯„è®ºçš„å¤„ç†

##
